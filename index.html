<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Uphome</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="Uphome">
<meta property="og:url" content="https://uphome.github.io/index.html">
<meta property="og:site_name" content="Uphome">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Uphome">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Uphome" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 7.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Uphome</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Search"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://uphome.github.io"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="test1.md-page" class="h-entry article article-type-test1.md" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/10/17/page/" class="article-date">
  <time class="dt-published" datetime="2024-10-16T16:03:58.000Z" itemprop="datePublished">2024-10-17</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/10/17/page/">搭建中</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        
      
    </div>
    <footer class="article-footer">
      <a data-url="https://uphome.github.io/2024/10/17/page/" data-id="cm2c5af890000sovt3338bmuk" data-title="搭建中" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-test" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/10/16/test/" class="article-date">
  <time class="dt-published" datetime="2024-10-16T15:14:03.687Z" itemprop="datePublished">2024-10-16</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/10/16/test/">项目记录（一）</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="简易HIS信息系统"><a href="#简易HIS信息系统" class="headerlink" title="简易HIS信息系统"></a>简易HIS信息系统</h1><hr>
<h4 id="项目描述："><a href="#项目描述：" class="headerlink" title="项目描述："></a>项目描述：</h4><p>这是一个简单的“医院挂号收费开药信息系统（Hospital Information System）简称HIS系统）”。<br>具有挂号 开药 诊断等基础功能。前端界面的设计也是能看就行。</p>
<hr>
<h4 id="相关说明："><a href="#相关说明：" class="headerlink" title="相关说明："></a>相关说明：</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">涉及语言：python HTML5  </span><br><span class="line">框架搭建：Flask  </span><br><span class="line">数据存储：SQLsever</span><br></pre></td></tr></table></figure>


<h4 id="组成部分："><a href="#组成部分：" class="headerlink" title="组成部分："></a>组成部分：</h4><p>整个项目由五个部分组成：<em>登录</em>，<em>收费</em>，<em>医生</em>，<em>检验</em>，<em>药房管理</em>，以及<em>用户管理</em>。</p>
<hr>
<h2 id="登录："><a href="#登录：" class="headerlink" title="登录："></a>登录：</h2><p>从前端获得输入的数据，然后进行逻辑判断。<br>逻辑判断需要判断用户名与密码是否匹配以及验证码验证。</p>
<h3 id="判断逻辑："><a href="#判断逻辑：" class="headerlink" title="判断逻辑："></a>判断逻辑：</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"> Uer = UserSet.Getuser();</span><br><span class="line">username = request.form[<span class="string">&#x27;username&#x27;</span>]</span><br><span class="line">password = request.form[<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line">Kind = request.form[<span class="string">&#x27;Kind&#x27;</span>]</span><br><span class="line"><span class="keyword">for</span> index <span class="keyword">in</span> Uer.keys():</span><br><span class="line">    <span class="keyword">if</span> Kind == index:</span><br><span class="line">        <span class="keyword">for</span> index1 <span class="keyword">in</span> Uer[index].keys():</span><br><span class="line">            <span class="keyword">if</span> index1 == username <span class="keyword">and</span> Uer[index][index1] == password:</span><br><span class="line">                url_array = [<span class="string">&#x27;All_bp.Toll&#x27;</span>,</span><br><span class="line">                             <span class="string">&#x27;All_bp.Doctor&#x27;</span>,</span><br><span class="line">                             <span class="string">&#x27;All_bp.Inspection&#x27;</span>,</span><br><span class="line">                             <span class="string">&#x27;All_bp.Pharmacy&#x27;</span>,</span><br><span class="line">                             <span class="string">&#x27;All_bp.superuser&#x27;</span>]</span><br><span class="line">                <span class="keyword">return</span> redirect(url_for(url_array[<span class="built_in">int</span>(Kind)]))  <span class="comment"># 输入的密码与验证码正确 则跳转到相应的板块</span></span><br></pre></td></tr></table></figure>

<h3 id="验证码实现："><a href="#验证码实现：" class="headerlink" title="验证码实现："></a>验证码实现：</h3><p>同时需要对输入的验证码进行对比。验证码是先生成五个字符，然后根据文本生成图片。字体文件直接在网上找的。并不复杂,挡不住图片识别。</p>
<p><strong>效果如下图：</strong><br><img alt="img.png" src="C:\Users\huwang\Downloads\1728977354342.png"/></p>
<p><strong>代码实现</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">generate_captcha</span>(<span class="params">size=(<span class="params"><span class="number">120</span>, <span class="number">40</span></span>), chars=string.ascii_letters + string.digits, captcha_length=<span class="number">5</span></span>):</span><br><span class="line">    <span class="comment"># 随机生成验证码文本</span></span><br><span class="line">    captcha_text = <span class="string">&#x27;&#x27;</span>.join(random.choice(chars) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(captcha_length))</span><br><span class="line">    <span class="comment"># 创建一个新图片</span></span><br><span class="line">    image = Image.new(<span class="string">&#x27;RGB&#x27;</span>, size, (<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>))</span><br><span class="line">    draw = ImageDraw.Draw(image)</span><br><span class="line">    font = ImageFont.truetype(<span class="string">&quot;chaptcha_ttf\imageCaptchaFont.ttf&quot;</span>, <span class="number">24</span>)</span><br><span class="line">    <span class="comment"># 绘制文本</span></span><br><span class="line">    draw.text((<span class="number">10</span>, <span class="number">10</span>), captcha_text, font=font, fill=(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>))</span><br><span class="line">    <span class="comment">#draw.text((10, 10), captcha_text, fill=(0, 0, 0))</span></span><br><span class="line">    <span class="comment"># 添加一些噪点</span></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">25</span>):</span><br><span class="line">        draw.point((random.randint(<span class="number">0</span>, size[<span class="number">0</span>]), random.randint(<span class="number">0</span>, size[<span class="number">1</span>])), fill=(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>))</span><br><span class="line">    image = image.<span class="built_in">filter</span>(ImageFilter.GaussianBlur(radius=<span class="number">1.5</span>))</span><br><span class="line">    <span class="keyword">return</span> image, captcha_text</span><br></pre></td></tr></table></figure>





<p><strong>改进</strong>：这里逻辑判断是自己写的，不过可以用<strong>Flask</strong>自带的这方面的，可能考虑到的情况更加的全以及安全性更高。<br>同时，验证码的字体也可以用稍微复杂的。验证方式 也可<strong>邮件</strong>验证码或者<strong>短信</strong>验证码。</p>
<hr>
<h2 id="收费"><a href="#收费" class="headerlink" title="收费"></a>收费</h2><p>我觉得在我现有的知识基础下，这个部分是最难写的。为了功能的写出，也是采用了不太优美的方法。</p>
<h3 id="挂号："><a href="#挂号：" class="headerlink" title="挂号："></a>挂号：</h3><p>这里直接从前端获得数据之后，需要将挂号的数据写入到数据库中，使用了<code>pyodbc</code>来对<br>SQLsever进行读写操作。</p>
<h4 id="代码实现："><a href="#代码实现：" class="headerlink" title="代码实现："></a>代码实现：</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;Setorder&#x27;</span> <span class="keyword">in</span> request.form:</span><br><span class="line">Name = request.form[<span class="string">&#x27;username&#x27;</span>]</span><br><span class="line">random.seed(time.time())</span><br><span class="line">ID = random.randint(<span class="number">1000000</span>, <span class="number">9999999</span>)  <span class="comment"># 随机病历ID</span></span><br><span class="line">Gender = request.form[<span class="string">&#x27;gender&#x27;</span>]</span><br><span class="line">Age = request.form[<span class="string">&#x27;age&#x27;</span>]</span><br><span class="line">DoctorID = request.form[<span class="string">&#x27;DoctorID&#x27;</span>]</span><br><span class="line"><span class="keyword">if</span> TollData.AddToll(ID, Name, Gender, Age, DoctorID):</span><br><span class="line">    flash(<span class="string">&quot;挂号成功！&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    flash(<span class="string">&quot;挂号失败！&quot;</span>)</span><br><span class="line">data = TollData.GetToll()  <span class="comment"># 写入自定义函数</span></span><br><span class="line"><span class="keyword">return</span> render_template(<span class="string">&#x27;Setorder.html&#x27;</span>, data=data)</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h4 id="数据库链接："><a href="#数据库链接：" class="headerlink" title="数据库链接："></a>数据库链接：</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Getdata</span>(<span class="params">Dataname, Kindname</span>):</span><br><span class="line">    conn_str = (</span><br><span class="line">        <span class="string">r&#x27;DRIVER=&#123;ODBC Driver 17 for SQL Server&#125;;&#x27;</span></span><br><span class="line">        <span class="string">r&#x27;SERVER=localhost;&#x27;</span></span><br><span class="line">        <span class="string">r&#x27;DATABASE=His_info;&#x27;</span></span><br><span class="line">        <span class="string">r&#x27;Trusted_Connection=yes;&#x27;</span></span><br><span class="line">    )</span><br><span class="line">    <span class="comment"># 创建连接</span></span><br><span class="line">    conn = pyodbc.connect(conn_str)</span><br><span class="line">    <span class="comment"># 创建一个Cursor对象并执行SQL查询</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        cursor = conn.cursor()</span><br><span class="line">        cursor.execute(<span class="string">&#x27;SELECT * FROM dbo.&#x27;</span> + Dataname)</span><br><span class="line">        <span class="comment"># 获取所有记录</span></span><br><span class="line">        rows = cursor.fetchall()</span><br><span class="line">        data = []</span><br><span class="line">        appendix = &#123;&#125;</span><br><span class="line">        <span class="keyword">for</span> row <span class="keyword">in</span> rows:</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(Kindname)):</span><br><span class="line">                appendix[Kindname[i]] = row[i]</span><br><span class="line">            data.append(appendix)</span><br><span class="line">            appendix = &#123;&#125;</span><br><span class="line">    <span class="keyword">except</span> pyodbc.Error <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;数据库操作失败: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="comment"># 如果出现错误，则回滚事务</span></span><br><span class="line">        conn.rollback()</span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        <span class="comment"># 关闭Cursor和连接</span></span><br><span class="line">        cursor.close()</span><br><span class="line">        conn.close()</span><br><span class="line">        <span class="keyword">return</span> data</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>项目里类似的函数还有很多，因为，不同的功能需求需要不同的写入读取规则，很难复用。</p>
<h3 id="收费："><a href="#收费：" class="headerlink" title="收费："></a>收费：</h3><p>这里 思路是对存入数据库的处方进行分析，得到所开的药以及进行了那些检验项目。然后读取药品数据库的信息进行计费。</p>
<h4 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">datas_Toll = GetData.Getdata(<span class="string">&quot;Toll_order&quot;</span>,</span><br><span class="line">                             [<span class="string">&#x27;Id&#x27;</span>, <span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;gender&#x27;</span>, <span class="string">&#x27;age&#x27;</span>, <span class="string">&#x27;docterid&#x27;</span>, <span class="string">&#x27;Datetime&#x27;</span>, <span class="string">&#x27;text&#x27;</span>, <span class="string">&#x27;prescription&#x27;</span>,</span><br><span class="line">                              <span class="string">&#x27;program&#x27;</span>])</span><br><span class="line">datas_Medicine = GetData.Getdata(<span class="string">&#x27;Medicine_info&#x27;</span>, [<span class="string">&#x27;medicname&#x27;</span>, <span class="string">&#x27;id&#x27;</span>, <span class="string">&#x27;price&#x27;</span>, <span class="string">&#x27;number&#x27;</span>])</span><br><span class="line">patients_tuples = []</span><br><span class="line"><span class="keyword">for</span> patient <span class="keyword">in</span> datas_Toll:</span><br><span class="line">    <span class="keyword">for</span> key <span class="keyword">in</span> patient:</span><br><span class="line">        <span class="keyword">if</span> key == <span class="string">&#x27;Id&#x27;</span> <span class="keyword">or</span> key.isdigit():</span><br><span class="line">            patient_id = patient[key]</span><br><span class="line">            patient_name = patient[<span class="string">&#x27;prescription&#x27;</span>]</span><br><span class="line">            patients_tuples.append((patient_id, patient_name))</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">program_tuples = []</span><br><span class="line"><span class="keyword">for</span> patient <span class="keyword">in</span> datas_Toll:</span><br><span class="line">    <span class="keyword">for</span> key <span class="keyword">in</span> patient:</span><br><span class="line">        <span class="keyword">if</span> key == <span class="string">&#x27;Id&#x27;</span> <span class="keyword">or</span> key.isdigit():</span><br><span class="line">            patient_id = patient[key]</span><br><span class="line">            patient_name = patient[<span class="string">&#x27;program&#x27;</span>]</span><br><span class="line">            program_tuples.append((patient_id, patient_name))</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">medicines_dict = &#123;med[<span class="string">&#x27;medicname&#x27;</span>]: <span class="built_in">int</span>(med[<span class="string">&#x27;price&#x27;</span>]) <span class="keyword">for</span> med <span class="keyword">in</span> datas_Medicine&#125;</span><br><span class="line">Price = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(program_tuples)):</span><br><span class="line">    total_proprice = <span class="number">0</span></span><br><span class="line">    <span class="comment"># TODO 这里的bug在于如果是空 会直接报错 没有验证下面这么写能不能跳过</span></span><br><span class="line">    <span class="keyword">if</span> program_tuples <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        flash(<span class="string">&#x27;存在项目为空的状态&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;存在项目为空的状态1&#x27;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> program_tuples[i][<span class="number">1</span>] == <span class="literal">None</span>:</span><br><span class="line">        flash(<span class="string">&quot;有人没有申请项目！&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;存在项目为空的状态111111&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;Setorder.html&#x27;</span>)</span><br><span class="line">    stripped_string = program_tuples[i][<span class="number">1</span>].strip(<span class="string">&#x27;-&#x27;</span>)</span><br><span class="line">    project_names = stripped_string.split(<span class="string">&#x27;-&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> program <span class="keyword">in</span> project_names:</span><br><span class="line">        total_proprice += (program_price.get(program) * <span class="number">1</span>)</span><br><span class="line">    Price.append(</span><br><span class="line">        [datas_Toll[i][<span class="string">&#x27;Id&#x27;</span>], datas_Toll[i][<span class="string">&#x27;name&#x27;</span>], datas_Toll[i][<span class="string">&#x27;prescription&#x27;</span>], datas_Toll[i][<span class="string">&#x27;program&#x27;</span>],</span><br><span class="line">         total_proprice])</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;----&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(Price)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(patients_tuples)):</span><br><span class="line">    pattern = <span class="string">r&#x27;([^*]+)\*(\d+)盒&#x27;</span></span><br><span class="line">    matches = re.findall(pattern, <span class="built_in">str</span>(patients_tuples[i][<span class="number">1</span>]))</span><br><span class="line">    medicines = []</span><br><span class="line">    total_mecprice = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> <span class="keyword">match</span> <span class="keyword">in</span> matches:</span><br><span class="line">        medicine_name = <span class="keyword">match</span>[<span class="number">0</span>]</span><br><span class="line">        quantity = <span class="built_in">int</span>(<span class="keyword">match</span>[<span class="number">1</span>])</span><br><span class="line">        medicines.append((<span class="built_in">str</span>(medicine_name), <span class="built_in">int</span>(quantity)))</span><br><span class="line">    <span class="keyword">for</span> record <span class="keyword">in</span> medicines:</span><br><span class="line">        <span class="keyword">if</span> record[<span class="number">0</span>] <span class="keyword">in</span> medicines_dict.keys():</span><br><span class="line">            total_mecprice += (medicines_dict.get(record[<span class="number">0</span>]) * record[<span class="number">1</span>])</span><br><span class="line">    Price[i][<span class="number">4</span>] = <span class="built_in">int</span>(total_mecprice) + Price[i][<span class="number">4</span>]</span><br><span class="line">converted_data = []</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> Price:</span><br><span class="line">    converted_item = &#123;</span><br><span class="line">        <span class="string">&#x27;Id&#x27;</span>: item[<span class="number">0</span>],</span><br><span class="line">        <span class="string">&#x27;name&#x27;</span>: item[<span class="number">1</span>],</span><br><span class="line">        <span class="string">&#x27;prescription&#x27;</span>: item[<span class="number">2</span>],</span><br><span class="line">        <span class="string">&#x27;program&#x27;</span>: item[<span class="number">3</span>],</span><br><span class="line">        <span class="string">&#x27;cost&#x27;</span>: item[<span class="number">4</span>]</span><br><span class="line">    &#125;</span><br><span class="line">    converted_data.append(converted_item)</span><br><span class="line"><span class="built_in">print</span>(converted_data)</span><br></pre></td></tr></table></figure>

<p>这里的实现逻辑并不优雅。代码逻辑有很大的提升空间。</p>
<hr>
<h2 id="医生："><a href="#医生：" class="headerlink" title="医生："></a>医生：</h2><p>医生板块主要涉及到<strong>检验申请</strong> <strong>开药方 写处方</strong>。主要从前端读取输入数据，然后处理之后与数据库进行交互。</p>
<h3 id="检验申请："><a href="#检验申请：" class="headerlink" title="检验申请："></a>检验申请：</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;Postorder&#x27;</span> <span class="keyword">in</span> request.form:</span><br><span class="line"><span class="built_in">id</span> = request.form[<span class="string">&#x27;Kindid&#x27;</span>]</span><br><span class="line"><span class="keyword">for</span> data <span class="keyword">in</span> all_datas:</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">int</span>(<span class="built_in">id</span>) == <span class="built_in">int</span>(data[<span class="string">&#x27;Id&#x27;</span>]):</span><br><span class="line">        name = data[<span class="string">&#x27;name&#x27;</span>]</span><br><span class="line">        sex = request.form[<span class="string">&#x27;sex&#x27;</span>]</span><br><span class="line">        time = datetime.now().strftime(<span class="string">&#x27;%Y-%m-%d %H:%M:%S&#x27;</span>)</span><br><span class="line">        program = request.form[<span class="string">&#x27;Program&#x27;</span>]</span><br><span class="line">        GetData.Adddata(<span class="string">&#x27;Program&#x27;</span>, [<span class="string">&#x27;Name&#x27;</span>, <span class="string">&#x27;Sex&#x27;</span>, <span class="string">&#x27;Time&#x27;</span>, <span class="string">&#x27;Program&#x27;</span>, <span class="string">&#x27;Id&#x27;</span>], [name, sex, time, program, <span class="built_in">id</span>])</span><br><span class="line">add_datas = [program + <span class="string">&#x27;-&#x27;</span>, <span class="built_in">id</span>]</span><br><span class="line">GetData.where_addtext(<span class="string">&#x27;Toll_order&#x27;</span>, add_datas, <span class="string">&#x27;program&#x27;</span>, <span class="string">&#x27;Id&#x27;</span>, <span class="string">&#x27;Onlyone&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>不再赘述，逻辑简单。</p>
<h3 id="写处方："><a href="#写处方：" class="headerlink" title="写处方："></a>写处方：</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="string">&#x27;putorder&#x27;</span> <span class="keyword">in</span> request.form:</span><br><span class="line">   result = request.form.getlist(<span class="string">&#x27;results[]&#x27;</span>)</span><br><span class="line">   <span class="keyword">if</span> <span class="built_in">len</span>(result) == <span class="number">0</span>:</span><br><span class="line">       flash(<span class="string">&quot;输入为空！请重新输入&quot;</span>)</span><br><span class="line">       <span class="keyword">return</span> render_template(<span class="string">&#x27;Docter.html&#x27;</span>, data=datas, programdata=datas_program)</span><br><span class="line">   adddata = []</span><br><span class="line">   <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(result)):</span><br><span class="line">       datas[i][<span class="string">&#x27;text&#x27;</span>] = result[i]</span><br><span class="line">       adddata.append([result[i], <span class="built_in">str</span>(datas[i][<span class="string">&#x27;Id&#x27;</span>])])</span><br><span class="line">   <span class="keyword">if</span> GetData.where_add(<span class="string">&quot;Toll_order&quot;</span>, adddata, <span class="string">&#x27;Text&#x27;</span>, <span class="string">&#x27;Id&#x27;</span>) == <span class="number">0</span>:</span><br><span class="line">       <span class="built_in">print</span>(<span class="string">&quot;无法保存数据！&quot;</span>)</span><br><span class="line">   datas = [Data <span class="keyword">for</span> Data <span class="keyword">in</span> datas <span class="keyword">if</span> Data[<span class="string">&#x27;text&#x27;</span>] <span class="keyword">is</span> <span class="literal">None</span>]</span><br><span class="line">   <span class="keyword">return</span> render_template(<span class="string">&#x27;Docter.html&#x27;</span>, data=datas, programdata=datas_program)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这里在前端有一些java语言，就不摆出来了，在仓库中，想看的可以看看。其他的不在赘述。</p>
<h3 id="开药方："><a href="#开药方：" class="headerlink" title="开药方："></a>开药方：</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">datas = GetData.Getdata(<span class="string">&quot;Toll_order&quot;</span>, [<span class="string">&#x27;Id&#x27;</span>, <span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;gender&#x27;</span>, <span class="string">&#x27;age&#x27;</span>, <span class="string">&#x27;docterid&#x27;</span>, <span class="string">&#x27;Datetime&#x27;</span>, <span class="string">&#x27;text&#x27;</span>])</span><br><span class="line">datas = [Data <span class="keyword">for</span> Data <span class="keyword">in</span> datas <span class="keyword">if</span> Data[<span class="string">&#x27;text&#x27;</span>] <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>]</span><br><span class="line"><span class="keyword">if</span> <span class="string">&#x27;order&#x27;</span> <span class="keyword">in</span> request.form:</span><br><span class="line">    mecnumber = request.form.getlist(<span class="string">&#x27;results[]&#x27;</span>)</span><br><span class="line">    mecid = request.form.getlist(<span class="string">&#x27;kind[]&#x27;</span>)</span><br><span class="line">    Medicine_info = session[<span class="string">&#x27;Medicine_info&#x27;</span>]</span><br><span class="line">    matched_medicines = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> i, mecid_value <span class="keyword">in</span> <span class="built_in">enumerate</span>(mecid):</span><br><span class="line">        <span class="keyword">for</span> medicine <span class="keyword">in</span> Medicine_info:</span><br><span class="line">            <span class="keyword">if</span> medicine[<span class="string">&#x27;id&#x27;</span>] == mecid_value:</span><br><span class="line">                matched_medicines[mecid_value] = [medicine[<span class="string">&#x27;id&#x27;</span>], medicine[<span class="string">&#x27;medicname&#x27;</span>], medicine[<span class="string">&#x27;price&#x27;</span>],</span><br><span class="line">                                                  mecnumber[i]]</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    all_mec = [matched_medicines[key] <span class="keyword">for</span> key <span class="keyword">in</span> mecid <span class="keyword">if</span> key <span class="keyword">in</span> matched_medicines]</span><br><span class="line">    Toler = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(datas)):</span><br><span class="line">        text = all_mec[i][<span class="number">1</span>] + <span class="string">&#x27;*&#x27;</span> + all_mec[i][<span class="number">3</span>] + <span class="string">&#x27;盒——&#x27;</span></span><br><span class="line">        Toler.append([text, datas[i][<span class="string">&#x27;Id&#x27;</span>]])</span><br><span class="line">    GetData.where_addtext(<span class="string">&#x27;Toll_order&#x27;</span>, Toler, <span class="string">&#x27;prescription&#x27;</span>, <span class="string">&#x27;Id&#x27;</span>, <span class="string">&#x27;Some&#x27;</span>)</span><br><span class="line">    all_mecdic = []</span><br><span class="line">    <span class="comment"># 修改库存逻辑</span></span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> all_mec:</span><br><span class="line">        converted_dict = &#123;</span><br><span class="line">            <span class="string">&#x27;MedicineName&#x27;</span>: item[<span class="number">1</span>],</span><br><span class="line">            <span class="string">&#x27;MedicineID&#x27;</span>: item[<span class="number">0</span>],</span><br><span class="line">            <span class="string">&#x27;Price&#x27;</span>: item[<span class="number">2</span>],</span><br><span class="line">            <span class="string">&#x27;Number&#x27;</span>: item[<span class="number">3</span>]</span><br><span class="line">        &#125;</span><br><span class="line">        all_mecdic.append(converted_dict)</span><br><span class="line">    session[<span class="string">&#x27;all_mec&#x27;</span>] = all_mecdic</span><br><span class="line">    Medicine_info = MedicineData.Get_medicine()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> all_mecdic:</span><br><span class="line">        update_dict = &#123;i[<span class="string">&#x27;MedicineID&#x27;</span>]: i[<span class="string">&#x27;Number&#x27;</span>]&#125;</span><br><span class="line">        <span class="keyword">for</span> medicine <span class="keyword">in</span> Medicine_info:</span><br><span class="line">            <span class="keyword">if</span> medicine[<span class="string">&#x27;MedicineID&#x27;</span>] <span class="keyword">in</span> update_dict:</span><br><span class="line">                medicine[<span class="string">&#x27;Number&#x27;</span>] = <span class="built_in">str</span>(<span class="built_in">int</span>(medicine[<span class="string">&#x27;Number&#x27;</span>]) - <span class="built_in">int</span>(update_dict[medicine[<span class="string">&#x27;MedicineID&#x27;</span>]]))</span><br><span class="line">    <span class="comment"># 判断药品不足</span></span><br><span class="line">    alter_Medicine_info = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> Medicine_info:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">int</span>(i[<span class="string">&#x27;Number&#x27;</span>]) &lt; <span class="number">0</span>:</span><br><span class="line">            flash(i[<span class="string">&#x27;MedicineName&#x27;</span>] + <span class="string">&#x27;不足！还差&#x27;</span> + <span class="built_in">str</span>(-<span class="built_in">int</span>(i[<span class="string">&#x27;Number&#x27;</span>])) + <span class="string">&#x27;请联系药房人员补货！&#x27;</span>)</span><br><span class="line">            i[<span class="string">&#x27;Number&#x27;</span>] = <span class="number">0</span></span><br><span class="line">        alter_Medicine_info.append([i[<span class="string">&#x27;Number&#x27;</span>], i[<span class="string">&#x27;MedicineID&#x27;</span>]])</span><br><span class="line">    GetData.where_add(<span class="string">&#x27;Medicine_info&#x27;</span>, alter_Medicine_info, <span class="string">&#x27;Number&#x27;</span>, <span class="string">&#x27;MedicineID&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>这里的，我在读取数据之后，直接对数据库的数据进行修改了，这样的话，方便很多了，就不用在下一个板块进行修改。</p>
<h2 id="检验："><a href="#检验：" class="headerlink" title="检验："></a>检验：</h2><p>这个板块主要是对<strong>检验项目</strong>的一个处理，以及对<strong>项目结果</strong>的输入。</p>
<p><strong>代码实现：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="string">&#x27;Setorder&#x27;</span> <span class="keyword">in</span> request.form:</span><br><span class="line">    add_Data = &#123;&#125;</span><br><span class="line">    result = request.form.getlist(<span class="string">&#x27;results[]&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(result) == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;Inspection.html&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(result)):</span><br><span class="line">        index = <span class="built_in">str</span>(data[i][<span class="string">&#x27;Time&#x27;</span>])</span><br><span class="line">        add_Data[index] = result[i]</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(add_Data):</span><br><span class="line">        Inspection_data.Add_inspection(<span class="string">&#x27;Program&#x27;</span>, add_Data)</span><br><span class="line">        data = []</span><br><span class="line">        <span class="keyword">for</span> row <span class="keyword">in</span> GetData.Getdata(<span class="string">&#x27;Program&#x27;</span>, [<span class="string">&#x27;Name&#x27;</span>, <span class="string">&#x27;Sex&#x27;</span>, <span class="string">&#x27;Time&#x27;</span>, <span class="string">&#x27;Program&#x27;</span>, <span class="string">&#x27;Result&#x27;</span>]):</span><br><span class="line">            <span class="keyword">if</span> row[<span class="string">&#x27;Result&#x27;</span>] <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">                data.append(row)</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;Inspection.html&#x27;</span>, data=data)</span><br></pre></td></tr></table></figure>

<p>简单的读取数据并处理，然后在进行一个数据的输入。</p>
<h2 id="药房："><a href="#药房：" class="headerlink" title="药房："></a>药房：</h2><p>这里主要是对存储的药房中的药品进行<strong>数量管理</strong>，以及药物<strong>增加</strong>与<strong>删除</strong>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="string">&#x27;Medicinealter&#x27;</span> <span class="keyword">in</span> request.form:  <span class="comment"># 修改库存</span></span><br><span class="line">    <span class="comment"># Kindname = [&#x27;MedicineID&#x27;, &#x27;MedicineName&#x27;, &#x27;Price&#x27;, &#x27;Number&#x27;]</span></span><br><span class="line">    medicineName = request.form[<span class="string">&#x27;MedicineName&#x27;</span>]</span><br><span class="line">    medicineID = request.form[<span class="string">&#x27;MedicineID&#x27;</span>]</span><br><span class="line">    medicinePrice = <span class="built_in">str</span>(request.form[<span class="string">&#x27;Price&#x27;</span>])</span><br><span class="line">    medicineNumber = request.form[<span class="string">&#x27;Number&#x27;</span>]</span><br><span class="line">    addData = [medicineID, medicineName, medicinePrice, medicineNumber]</span><br><span class="line">    MedicineData.Alter_medicine(addData)</span><br><span class="line">    data = MedicineData.Get_medicine()</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;Pharmacy.html&#x27;</span>, data=data)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>内容逻辑简单，不在赘述。</p>
<h2 id="超级用户："><a href="#超级用户：" class="headerlink" title="超级用户："></a>超级用户：</h2><p>这里是管理用户，用户的<strong>注册与删除</strong>。原本的验证阶段放到前面的登录模块做了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">datas = GetData.Getdata(<span class="string">&#x27;loginuser&#x27;</span>, [<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;password&#x27;</span>, <span class="string">&#x27;kind&#x27;</span>])</span><br><span class="line">dic = &#123;<span class="number">0</span>: <span class="string">&#x27;收费人员&#x27;</span>, <span class="number">1</span>: <span class="string">&#x27;医生&#x27;</span>, <span class="number">2</span>: <span class="string">&#x27;检验科室人员&#x27;</span>, <span class="number">3</span>: <span class="string">&#x27;药房人员&#x27;</span>, <span class="number">4</span>: <span class="string">&#x27;系统超级用户&#x27;</span>, &#125;</span><br><span class="line"><span class="keyword">for</span> data <span class="keyword">in</span> datas:</span><br><span class="line">    data[<span class="string">&#x27;kind&#x27;</span>] = dic[<span class="built_in">int</span>(data[<span class="string">&#x27;kind&#x27;</span>].strip())]</span><br><span class="line">    data[<span class="string">&#x27;name&#x27;</span>] = data[<span class="string">&#x27;name&#x27;</span>].strip()</span><br><span class="line">    data[<span class="string">&#x27;password&#x27;</span>] = data[<span class="string">&#x27;password&#x27;</span>].strip()</span><br><span class="line"><span class="keyword">return</span> render_template(<span class="string">&#x27;superuser.html&#x27;</span>, datas=datas)</span><br><span class="line"><span class="keyword">if</span> <span class="string">&#x27;POST&#x27;</span> == request.method:</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;signup&#x27;</span> <span class="keyword">in</span> request.form:</span><br><span class="line">        username = request.form[<span class="string">&#x27;username&#x27;</span>]</span><br><span class="line">        password = request.form[<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line">        Kind = request.form[<span class="string">&#x27;Kind&#x27;</span>]</span><br><span class="line">        <span class="keyword">if</span> username != <span class="string">&#x27;&#x27;</span> <span class="keyword">and</span> password != <span class="string">&#x27;&#x27;</span> <span class="keyword">and</span> <span class="built_in">int</span>(Kind) != <span class="string">&#x27;&#x27;</span> <span class="keyword">and</span> <span class="number">4</span> &gt;= <span class="built_in">int</span>(Kind) &gt;= <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;格式合格&#x27;</span>)</span><br><span class="line">            <span class="keyword">if</span> UserSet.Adduser(username, password, Kind):</span><br><span class="line">                flash(<span class="string">&quot;成功注册&quot;</span>)</span><br><span class="line">                datas = GetData.Getdata(<span class="string">&#x27;loginuser&#x27;</span>, [<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;password&#x27;</span>, <span class="string">&#x27;kind&#x27;</span>])</span><br><span class="line">                dic = &#123;<span class="number">0</span>: <span class="string">&#x27;收费人员&#x27;</span>, <span class="number">1</span>: <span class="string">&#x27;医生&#x27;</span>, <span class="number">2</span>: <span class="string">&#x27;检验科室人员&#x27;</span>, <span class="number">3</span>: <span class="string">&#x27;药房人员&#x27;</span>, <span class="number">4</span>: <span class="string">&#x27;系统超级用户&#x27;</span>, &#125;</span><br><span class="line">                <span class="keyword">for</span> data <span class="keyword">in</span> datas:</span><br><span class="line">                    data[<span class="string">&#x27;kind&#x27;</span>] = dic[<span class="built_in">int</span>(data[<span class="string">&#x27;kind&#x27;</span>].strip())]</span><br><span class="line">                    data[<span class="string">&#x27;name&#x27;</span>] = data[<span class="string">&#x27;name&#x27;</span>].strip()</span><br><span class="line">                    data[<span class="string">&#x27;password&#x27;</span>] = data[<span class="string">&#x27;password&#x27;</span>].strip()</span><br><span class="line">                <span class="keyword">return</span> render_template(<span class="string">&#x27;superuser.html&#x27;</span>, datas=datas)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                flash(<span class="string">&quot;注册失败&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            flash(<span class="string">&quot;请按照格式进行注册！&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        datas = GetData.Getdata(<span class="string">&#x27;loginuser&#x27;</span>, [<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;password&#x27;</span>, <span class="string">&#x27;kind&#x27;</span>])</span><br><span class="line">        dic = &#123;<span class="number">0</span>: <span class="string">&#x27;收费人员&#x27;</span>, <span class="number">1</span>: <span class="string">&#x27;医生&#x27;</span>, <span class="number">2</span>: <span class="string">&#x27;检验科室人员&#x27;</span>, <span class="number">3</span>: <span class="string">&#x27;药房人员&#x27;</span>, <span class="number">4</span>: <span class="string">&#x27;系统超级用户&#x27;</span>, &#125;</span><br><span class="line">        <span class="keyword">for</span> data <span class="keyword">in</span> datas:</span><br><span class="line">            data[<span class="string">&#x27;kind&#x27;</span>] = dic[<span class="built_in">int</span>(data[<span class="string">&#x27;kind&#x27;</span>].strip())]</span><br><span class="line">            data[<span class="string">&#x27;name&#x27;</span>] = data[<span class="string">&#x27;name&#x27;</span>].strip()</span><br><span class="line">            data[<span class="string">&#x27;password&#x27;</span>] = data[<span class="string">&#x27;password&#x27;</span>].strip()</span><br><span class="line"><span class="keyword">return</span> render_template(<span class="string">&#x27;superuser.html&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>这里 主要是<strong>读写数据库中的数据</strong>并处理，然后传递给<strong>后端</strong>。</p>
<h2 id="总结："><a href="#总结：" class="headerlink" title="总结："></a>总结：</h2><p>这个项目比较简单，因为实现的功能不多。虽然简单，但是这是我第一次接触到这方面，因此有很多的可以优化甚至是修改的地方。<br>同时，整体的代码结构需要修改，一些方法的实现可以更好。对于Flask的使用方法还需要深入，对于python 以及html5的一些语言特性也要更好的掌握。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://uphome.github.io/2024/10/16/test/" data-id="cm2c5af8d0001sovtc105hxtk" data-title="项目记录（一）" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/10/">October 2024</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2024/10/17/page/">搭建中</a>
          </li>
        
          <li>
            <a href="/2024/10/16/test/">项目记录（一）</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2024 Uphome<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>